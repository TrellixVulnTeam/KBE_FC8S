#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
# Copyright (C) 2016-2021 ParaPy Holding B.V.
#
# This file is subject to the terms and conditions defined in
# the license agreement that you have received with this source code
#
# THIS CODE AND INFORMATION ARE PROVIDED "AS IS" WITHOUT WARRANTY OF ANY
# KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
# IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR
# PURPOSE.

"""Monkey-patches some OCC Array classes with extra factory classes
ParaPy->OCC or with properties for conversion OCC->ParaPy/Python"""

from OCC.wrapper.TColgp import (TColgp_HArray1OfPnt, TColgp_Array1OfPnt,
                        TColgp_Array2OfPnt)
from OCC.wrapper.TColStd import (TColStd_Array1OfReal, TColStd_Array1OfInteger,
                         TColStd_Array2OfReal)

# this import is necessary to get monkey-patched gp_Pnt and gp_Vec classes.
from OCC.utils.patched.tcol import (_TColgp_HArray1OfPnt_tuples,
                                    _TColgp_HArray1OfPnt_lists,
                                    _TColgp_Array1OfPnt_string,
                                    _TColgp_Array1OfPnt_lists,
                                    _TColgp_Array1OfPnt_tuples,
                                    _TColStd_Array1OfInteger_list,
                                    _TColStd_Array1OfReal_list,
                                    _TColStd_Array2OfReal_lists)
from OCC.utils.tcol import (make_TColgp_HArray1OfPnt,
                            make_TColgp_Array1OfPnt,
                            make_TColgp_Array2OfPnt,
                            make_TColStd_Array1OfReal,
                            make_TColStd_Array2OfReal,
                            make_TColStd_Array1OfInteger,
                            make_TColgp_Array1OfVec,
                            make_TColStd_HArray1OfBoolean)

from parapy.geom.occ.patched.gp import *  # @UnusedWildImport


# =============================================================================
# TColgp_HArray1OfPnt patches
# =============================================================================
TColgp_HArray1OfPnt_factory = make_TColgp_HArray1OfPnt


def _TColgp_HArray1OfPnt_points(self):
    """Returns: [Point(x,y,z), Point(x,y,z), ...]"""
    arr = self.Array1()
    return arr.points


TColgp_HArray1OfPnt.tuples = property(_TColgp_HArray1OfPnt_tuples)
TColgp_HArray1OfPnt.lists = property(_TColgp_HArray1OfPnt_lists)
TColgp_HArray1OfPnt.points = property(_TColgp_HArray1OfPnt_points)


# =============================================================================
# TColgp_Array1OfPnt patches
# =============================================================================
TColgp_Array1OfPnt_factory = make_TColgp_Array1OfPnt


def _TColgp_Array1OfPnt_points(self):
    return [self.Value(i + 1).point for i in range(self.Length())]


TColgp_Array1OfPnt.tuple = property(_TColgp_Array1OfPnt_tuples)
TColgp_Array1OfPnt.list = property(_TColgp_Array1OfPnt_lists)
TColgp_Array1OfPnt.points = property(_TColgp_Array1OfPnt_points)
TColgp_Array1OfPnt.string = property(_TColgp_Array1OfPnt_string)


# =============================================================================
# TColgp_Array2OfPnt patches
# =============================================================================
TColgp_Array2OfPnt_factory = make_TColgp_Array2OfPnt


def _TColgp_Array2OfPnt_points(self):
    return [[self.Value(i, j).point \
             for j in range(self.LowerCol(), self.UpperCol() + 1)] \
            for i in range(self.LowerRow(), self.UpperRow() + 1)]


TColgp_Array2OfPnt.points = property(_TColgp_Array2OfPnt_points)


# =============================================================================
# TColStd_Array1OfReal patches
# =============================================================================
TColStd_Array1OfReal_factory = make_TColStd_Array1OfReal


TColStd_Array1OfReal.list = property(_TColStd_Array1OfReal_list)


# =============================================================================
# TColStd_Array2OfReal patches
# =============================================================================
TColStd_Array2OfReal_factory = make_TColStd_Array2OfReal

TColStd_Array2OfReal.list = property(_TColStd_Array2OfReal_lists)


# =============================================================================
# TColStd_Array1OfInteger patches
# =============================================================================
TColStd_Array1OfInteger_factory = make_TColStd_Array1OfInteger


TColStd_Array1OfInteger.list = property(_TColStd_Array1OfInteger_list)


# =============================================================================
# TColgp_Array1OfVec patches
# =============================================================================
TColgp_Array1OfVec_factory = make_TColgp_Array1OfVec


# =============================================================================
# TColStd_HArray1OfBoolean patches
# =============================================================================
TColStd_HArray1OfBoolean_factory = make_TColStd_HArray1OfBoolean
