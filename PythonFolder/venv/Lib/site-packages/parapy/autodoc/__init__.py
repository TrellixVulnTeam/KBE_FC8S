#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
# Copyright (C) 2016-2021 ParaPy Holding B.V.
#
# This file is subject to the terms and conditions defined in
# the license agreement that you have received with this source code
#
# THIS CODE AND INFORMATION ARE PROVIDED "AS IS" WITHOUT WARRANTY OF ANY
# KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
# IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR
# PURPOSE.


def setup(app):
    # type: (Sphinx) -> Dict[unicode, Any]

    import sphinx
    from sphinx.ext import autodoc
    from sphinx.ext.autodoc import AutoDirective
    from docutils.parsers.rst import directives

    from parapy.autodoc.main import (ClassDocumenter, SlotDocumenter,
                                     MethodDocumenter, InputDocumenter,
                                     py_role_fn)

    if 'autoclass' not in directives._directives:
        autodoc.setup(app)

    autodoc.add_documenter(ClassDocumenter)
    # app.add_directive('autoppclass', autodoc.AutoDirective)

    # AutoDirective._registry['ppclass'] = PPClassDocumenter
    AutoDirective._registry['ppslot'] = SlotDocumenter
    AutoDirective._registry['ppinput'] = InputDocumenter
    AutoDirective._registry['ppmethod'] = MethodDocumenter
    app.add_role('py', py_role_fn)

    return {'version': sphinx.__display_version__, 'parallel_read_safe': True}
