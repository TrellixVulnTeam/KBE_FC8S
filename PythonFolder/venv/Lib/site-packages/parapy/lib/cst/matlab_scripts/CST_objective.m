function[error] = CST_objective(x, X_u, Y_u)

% Determine upper and lower CST parameters from design-vector
Au = x;

% Perform mapping of CST method twice, for both upper (Au) and lower (Al) surface
% CST parameters; use corresponding upper and lower surface x-ordinates from E553
% [Co_CST_up, Co_discard] = D_airfoil2(Au,Al,X_u);
% [Co_discard2, Co_CST_low] = D_airfoil2(Au,Al,X_l);

[Co_CST_up,C] = D_airfoil2(Au,X_u);


% upper and lower partial fiting-error vectors
error_up = Y_u - Co_CST_up(:,2);
%error_low = Y_l - Co_CST_low(:,2);

% final objective value
error = sum(error_up.^2); %+ sum(error_low.^2);
end

