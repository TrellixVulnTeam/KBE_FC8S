#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
# Copyright (C) 2016-2021 ParaPy Holding B.V.
#
# This file is subject to the terms and conditions defined in
# the license agreement that you have received with this source code
#
# THIS CODE AND INFORMATION ARE PROVIDED "AS IS" WITHOUT WARRANTY OF ANY
# KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
# IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR
# PURPOSE.

import os
import sys

#: directory of the parapy.lib.avl package
#: :type: str
PKG_DIR = os.path.dirname(os.path.abspath(__file__))


def find_avl_executable():
    """Return location of avl.exe. Unless defined as environment variable
    'AVL_EXE', it points to the default location of avl.exe shipped with
    this package.

    :rtype: str
    :raises RuntimeError: if AVL_EXE points to non-existing location or when
        when avl.exe couldn't be found in default location(s).
    """
    _AVL_EXE_USER = os.environ.get('AVL_EXE')
    if _AVL_EXE_USER is not None:
        filename = os.path.abspath(_AVL_EXE_USER)
        if not os.path.exists(filename):
            msg = ("Environment variable 'AVL_EXE' is pointing to "
                   "non-existing location: '{}'. Fix location.")
            raise RuntimeError(msg.format(filename))
        else:
            return filename
    else:
        if sys.platform == 'linux':
            filename = os.path.join(PKG_DIR, "avl")
        else:
            filename = os.path.join(PKG_DIR, "avl.exe")
        if not os.path.exists(filename):
            msg = ("Couldn't find avl.exe on your system. Download it and add "
                   "the full path to avl.exe (windows) or avl (linux) "
                   "to a new environment variable 'AVL_EXE'")
            raise RuntimeError(msg)
        else:
            return filename

from parapy.lib.avl.primitives import (Interface, Geometry, Surface, Section,
                                       AirfoilSection, AirfoilCurveSection,
                                       Body)
from parapy.lib.avl.airfoil import naca4_points, airfoil_le_parameter

if __name__ == '__main__':
    print(find_avl_executable())
