#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
# Copyright (C) 2016-2021 ParaPy Holding B.V.
#
# This file is subject to the terms and conditions defined in
# the license agreement that you have received with this source code
#
# THIS CODE AND INFORMATION ARE PROVIDED "AS IS" WITHOUT WARRANTY OF ANY
# KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
# IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR
# PURPOSE.

from OCC.wrapper.Approx import Approx_ChordLength
from OCC.wrapper.GeomAPI import GeomAPI_PointsToBSplineSurface
from OCC.wrapper.GeomAbs import GeomAbs_C2

from OCC.utils.tcol import make_TColgp_Array2OfPnt

__all__ = ["points_to_bspline_surface"]
__author__ = "Reinier van Dijk (support@parapy.org)"


def points_to_bspline_surface(points, min_degree=3, max_degree=8,
                              continuity=GeomAbs_C2, precision=1.0e-3,
                              parameterization=Approx_ChordLength):
    points = make_TColgp_Array2OfPnt(points)
    builder = GeomAPI_PointsToBSplineSurface(points, parameterization,
                                             min_degree, max_degree,
                                             continuity, precision)
    if builder.IsDone():
        return builder.Surface()
    else:
        raise RuntimeError("fitting failed.")
