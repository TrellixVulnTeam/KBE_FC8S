#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
# Copyright (C) 2016-2021 ParaPy Holding B.V.
#
# This file is subject to the terms and conditions defined in
# the license agreement that you have received with this source code
#
# THIS CODE AND INFORMATION ARE PROVIDED "AS IS" WITHOUT WARRANTY OF ANY
# KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
# IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR
# PURPOSE.

"""Monkey-patches on OCC classes"""

from OCC.wrapper.gp import gp_Pnt, gp_Pnt2d


def _gp_Pnt_tuple(self):
    """ Converts a gp_Pnt to a tuple

    :param OCC.gp.gp_Pnt self: the point
    :return: tuple[float]
    """
    return tuple(self.Coord())


def _gp_Pnt_list(self):
    """ Converts a gp_Pnt to a list

    :param OCC.gp.gp_Pnt self: the point
    :return: list[float]
    """
    return self.Coord()


def _gp_Pnt_string(self):
    """ String representation of a gp_Pnt

    :param OCC.gp.gp_Pnt self: the point
    :return: str
    """
    return "{:1.6f} {:1.6f} {:1.6f}".format(*self.Coord())


def _gp_Pnt2d_tuple(self):
    """ Converts a gp_Pnt2d to a tuple

    :param OCC.gp.gp_Pnt2d self: the point
    :return: tuple[float]
    """
    return tuple(self.Coord())


def _gp_Pnt2d_list(self):
    """ Converts a gp_Pnt2d to a list

    :param OCC.gp.gp_Pnt2d self: the point
    :return: list[float]
    """
    return self.Coord()


def _gp_Pnt2d_string(self):
    """ String representation of a gp_Pnt2d

    :param OCC.gp.gp_Pnt2d self: the point
    :return: str
    """
    return "{:1.6f} {:1.6f}".format(*self.Coord())


gp_Pnt.tuple = property(_gp_Pnt_tuple)
gp_Pnt.list = property(_gp_Pnt_list)
gp_Pnt.string = property(_gp_Pnt_string)
gp_Pnt2d.tuple = property(_gp_Pnt2d_tuple)
gp_Pnt2d.list = property(_gp_Pnt2d_list)
gp_Pnt2d.string = property(_gp_Pnt2d_string)
